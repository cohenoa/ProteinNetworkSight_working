version: '4.1.0'

services:
  frontend:
    image: medmolnet-frontend
    build:
      context: ./frontend
      dockerfile: Dockerfile
    volumes:
      - ./frontend/src:/usr/src/app/src
    networks:
      - medmolnet-network
    container_name: prod-front

  backend:
    image: medmolnet-backend
    build:
      context: ./backend
      dockerfile: Dockerfile
    volumes:
      - ./backend:/python-docker
    networks:
      - medmolnet-network
    container_name: prod-back

  nginx:
    image: nginx
    restart: unless-stopped
    volumes:
      - ./nginx:/etc/nginx
      - ./certbot/conf:/etc/letsencrypt
      - ./certbot/www:/var/www/certbot
    networks:
      - medmolnet-network
    ports:
      - "80:80"
      - "8080:8080"
    container_name: prod-nginx

networks:
  medmolnet-network:
    driver: bridge


# Uncomment and configure certbot if needed
# certbot:
#   image: certbot/certbot
#   container_name: certbot
#   depends_on:
#     - nginx
#   volumes: 
#     - ./certbot/conf:/etc/letsencrypt
#     - ./certbot/www:/var/www/certbot
#   command: certonly --webroot -w /var/www/certbot  --email nitzanmr@gmail.com -d proteinnetworksight.jce.ac -d medmolnet.jce.ac --expand --agree-tos --non-interactive
#   networks:
#     - medmolnet-network
